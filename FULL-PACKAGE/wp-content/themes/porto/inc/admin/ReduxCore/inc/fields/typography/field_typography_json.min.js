!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],r=!1,a={width:"resolve",triggerChange:!0,allowClear:!0};e(document).ready((function(){})),redux.field_objects.typography.init=function(o,p){o||(o=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(o).each((function(){var o,p=e(this),y=p;(p.hasClass("redux-field-container")||(y=p.parents(".redux-field-container:first")),y.is(":hidden"))||y.hasClass("redux-field-init")&&(y.removeClass("redux-field-init"),p.each((function(){e(this).find(".redux-typography-container").each((function(){var t=e(this).find(".redux-typography-family");void 0===t.data("value")?t=e(this):""!==t.data("value")&&e(t).val(t.data("value"));var r=e(this).find(".select2_params");if(r.length){var p=r.val();p=JSON.parse(p),a=e.extend({},a,p)}o=Boolean(e(this).find(".redux-font-clear").val()),redux.field_objects.typography.select(t,!0),window.onbeforeunload=null})),e(this).find(".redux-typography").on("change",(function(){redux.field_objects.typography.select(e(this))})),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").keyup((function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))})),e(this).find(".redux-typography-color").wpColorPicker({palettes:["var(--porto-primary-color)","var(--porto-secondary-color)","var(--porto-tertiary-color)","var(--porto-quaternary-color)","var(--porto-dark-color)","var(--porto-light-color)","var(--porto-primary-light-5)"],change:function(t,r){e(this).val(r.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0});var y=[{id:"none",text:"none"}];e(this).find(".redux-typography-family").select2({matcher:function(e,t){return 0===t.toUpperCase().indexOf(e.toUpperCase())},query:function(e){return window.Select2.query.local(y)(e)},initSelection:function(e,t){t({id:e.val(),text:e.val()})},allowClear:o}).on("select2-opening",(function(t){var r=e(this).parents(".redux-container-typography:first").attr("data-id"),a=e("#"+r+" .redux-typography-font-family").data("user-fonts");a=a?1:0;var o=e("#"+r+" .redux-typography-google").val();o=o?1:0;var p=[];if(void 0!==redux.customfonts&&p.push(redux.customfonts),void 0!==redux.stdfonts&&0===a&&p.push(redux.stdfonts),1==a){var s=[];for(var i in redux.typography[r]){var l=redux.typography[r].std_font;for(var n in l)l.hasOwnProperty(n)&&s.push({id:n,text:n,"data-google":"false"})}var d={text:"Standard Fonts",children:s};p.push(d)}(1==o||!0===o&&void 0!==redux.googlefonts)&&p.push(redux.googlefonts),y=p;var u=e("#"+r+" #"+r+"-family").attr("placeholder");u||(u=null),e("#"+r+" .redux-typography-family").select2("val",u)})).on("select2-selecting",(function(a,o){var p=a.object.text,y=e(this).parents(".redux-container-typography:first").attr("data-id");e("#"+y+" #"+y+"-family").data("value",p),e("#"+y+" #"+y+"-family").attr("placeholder",p),t=a,r=!0,redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))})).on("select2-clearing",(function(t,r){var a=e(this).parents(".redux-container-typography:first").attr("data-id");e("#"+a+" #"+a+"-family").attr("data-value",""),e("#"+a+" #"+a+"-family").attr("placeholder","Font Family"),e("#"+a+" #"+a+"-google-font").val("false"),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))})),p.find(".redux-typography-family").hasClass("redux-typography-family")||p.find(".redux-typography-style").select2(a),p.find(".redux-typography-family-backup, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").select2(a)})))}))},redux.field_objects.typography.size=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},redux.field_objects.typography.makeBool=function(e){return"false"!=e&&"0"!=e&&!1!==e&&0!==e&&("true"==e||"1"==e||!0===e||1==e||void 0)},redux.field_objects.typography.change=function(e){var t={};jQuery(e).find(".redux-typography-input").each((function(){void 0!==jQuery(this).data("name")&&(t[jQuery(this).data("name")]=jQuery(this).val())})),jQuery(e).find(".typography-data-input:first-child").val(JSON.stringify(t))},redux.field_objects.typography.contrastColour=function(e){var t="#444444";""!==e&&(e=e.replace("#",""),t=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"#444444":"#ffffff");return t},redux.field_objects.typography.select=function(o,p){var y;void 0===(y=e(o).parents(".redux-container-typography:first").attr("data-id"))&&(y=e(o).attr("data-id"));e(o).parents(".redux-container-typography:first");var s=e("#"+y+" #"+y+"-family").val();s||(s=null);var i,l=e("#"+y+" select.redux-typography-family-backup").val(),n=e("#"+y+" .redux-typography-size").val(),d=e("#"+y+" .redux-typography-height").val(),u=e("#"+y+" .redux-typography-word").val(),h=e("#"+y+" .redux-typography-letter").val(),g=e("#"+y+" select.redux-typography-align").val(),c=e("#"+y+" select.redux-typography-transform").val(),f=e("#"+y+" select.redux-typography-font-variant").val(),v=e("#"+y+" select.redux-typography-decoration").val(),x=e("#"+y+" select.redux-typography-style").val(),b=e("#"+y+" select.redux-typography-subsets").val(),m=e("#"+y+" .redux-typography-color").val(),w=e("#"+y).data("units");!0===r?(i=redux.field_objects.typography.makeBool(t.object["data-google"]),e("#"+y+" .redux-typography-google-font").val(i)):i=redux.field_objects.typography.makeBool(e("#"+y+" .redux-typography-google-font").val()),e("#"+y).hasClass("typography-initialized")||(x=e("#"+y+" select.redux-typography-style").data("value"),b=e("#"+y+" select.redux-typography-subsets").data("value"),""!==x&&(x=String(x)),void 0!==typeof b&&(b=String(b))),void 0===redux.fonts.google&&(i=!1);var j="";if(j=!0===i&&s in redux.fonts.google?redux.fonts.google[s]:{400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(o).hasClass("redux-typography-subsets")&&e("#"+y+" input.typography-subsets").val(b),e(o).hasClass("redux-typography-family")){var _='<option value=""></option>';if(!0===i){var C="";e.each(j.variants,(function(e,t){t.id===x||1===redux.field_objects.typography.size(j.variants)?(C=' selected="selected"',x=t.id):C="",_+='<option value="'+t.id+'"'+C+">"+t.name.replace(/\+/g," ")+"</option>"})),e("#"+y+" .redux-typography-style").select2("destroy"),e("#"+y+" .redux-typography-style").html(_),e("#"+y+" .redux-typography-style").select2(a),C="",_='<option value=""></option>',e.each(j.subsets,(function(t,r){r.id===b||1===redux.field_objects.typography.size(j.subsets)?(C=' selected="selected"',b=r.id,e("#"+y+" input.typography-subsets").val(b)):C="",_+='<option value="'+r.id+'"'+C+">"+r.name.replace(/\+/g," ")+"</option>"})),e("#"+y+" .redux-typography-subsets").select2("destroy"),e("#"+y+" .redux-typography-subsets").html(_),e("#"+y+" .redux-typography-subsets").select2(a),e("#"+y+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+y+" .typography-family-backup").fadeIn("fast")}else j&&(e.each(j,(function(t,r){t===x||"normal"===t?(C=' selected="selected"',e("#"+y+" .typography-style .select2-chosen").text(r)):C="",_+='<option value="'+t+'"'+C+">"+r.replace("+"," ")+"</option>"})),e("#"+y+" .redux-typography-style").select2("destroy"),e("#"+y+" .redux-typography-style").html(_),e("#"+y+" .redux-typography-style").select2(a),e("#"+y+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+y+" .typography-family-backup").fadeOut("fast"));e("#"+y+" .redux-typography-font-family").val(s)}else e(o).hasClass("redux-typography-family-backup")&&""!==l&&e("#"+y+" .redux-typography-font-family-backup").val(l);if(0===e("#"+y+" select.redux-typography-style option[value='"+x+"']").length?(x="",e("#"+y+" select.redux-typography-style").select2("val","")):"400"===x&&e("#"+y+" select.redux-typography-style").select2("val",x),0===e("#"+y+" select.redux-typography-subsets option[value='"+b+"']").length&&(b="",e("#"+y+" select.redux-typography-subsets").select2("val",""),e("#"+y+" input.typography-subsets").val(b)),e("."+("style_link_"+y)).remove(),null!==s&&"inherit"!==s&&e("#"+y).hasClass("typography-initialized")){var z=s.replace(/\s+/g,"+");if(!0===i){var k=z;x&&""!==x&&(k+=":"+x.replace(/\-/g," ")),b&&""!==b&&(k+="&subset="+b),!1===r&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[k]}}),e("#"+y+" .redux-typography-google").val(!0)}else e("#"+y+" .redux-typography-google").val(!1)}(-1!==x.indexOf("italic")?(e("#"+y+" .typography-preview").css("font-style","italic"),e("#"+y+" .typography-font-style").val("italic"),x=x.replace("italic","")):(e("#"+y+" .typography-preview").css("font-style","normal"),e("#"+y+" .typography-font-style").val("")),e("#"+y+" .typography-font-weight").val(x),d||(d=n),""===n||void 0===n?e("#"+y+" .typography-font-size").val(""):e("#"+y+" .typography-font-size").val(n+w),""===d||void 0===d?e("#"+y+" .typography-line-height").val(""):e("#"+y+" .typography-line-height").val(d+w),""===u||void 0===u?e("#"+y+" .typography-word-spacing").val(""):e("#"+y+" .typography-word-spacing").val(u+w),""===h||void 0===h?e("#"+y+" .typography-letter-spacing").val(""):e("#"+y+" .typography-letter-spacing").val(h+w),e("#"+y).hasClass("typography-initialized"))&&("0"==e("#"+y+" .typography-preview").data("preview-size")&&e("#"+y+" .typography-preview").css("font-size",n+w),e("#"+y+" .typography-preview").css("font-weight",x),e("#"+y+" .typography-preview").css("font-family",s+", sans-serif"),"none"===s&&""===s&&e("#"+y+" .typography-preview").css("font-family","inherit"),e("#"+y+" .typography-preview").css("line-height",d+w),e("#"+y+" .typography-preview").css("word-spacing",u+w),e("#"+y+" .typography-preview").css("letter-spacing",h+w),m&&(e("#"+y+" .typography-preview").css("color",m),e("#"+y+" .typography-preview").css("background-color",redux.field_objects.typography.contrastColour(m))),e("#"+y+" .typography-style .select2-chosen").text(e("#"+y+" .redux-typography-style option:selected").text()),e("#"+y+" .typography-script .select2-chosen").text(e("#"+y+" .redux-typography-subsets option:selected").text()),g&&e("#"+y+" .typography-preview").css("text-align",g),c&&e("#"+y+" .typography-preview").css("text-transform",c),f&&e("#"+y+" .typography-preview").css("font-variant",f),v&&e("#"+y+" .typography-preview").css("text-decoration",v),e("#"+y+" .typography-preview").slideDown());e("#"+y).hasClass("typography-initialized")||e("#"+y).addClass("typography-initialized"),r=!1,p||redux_change(o)}}(jQuery);